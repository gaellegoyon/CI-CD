name: EnquÃªte policiÃ¨re

on:
  push:

jobs:
  policier-scene:
    runs-on: ubuntu-latest
    outputs:
      empreinte: ${{ steps.collect-empreinte.outputs.empreinte }}
    steps:
      - id: collect-empreinte
        run: |
          echo "empreinte=empreinte trouvÃ©e sur la caisse" >> $GITHUB_OUTPUT
      - name: Examiner la caisse enregistreuse
        run: echo "Le policier examine la caisse enregistreuse"
      - name: PrÃ©lever une empreinte
        run: echo "Empreinte prÃ©levÃ©e sur la caisse"

  policier-video:
    runs-on: ubuntu-latest
    outputs:
      video: ${{ steps.collect-video.outputs.resultat }}
    steps:
      - id: collect-video
        run: |
          echo "resultat=SÃ©quence vidÃ©o 22h15-22h45 rÃ©cupÃ©rÃ©e" >> $GITHUB_OUTPUT
      - name: VidÃ©o rÃ©cupÃ©rÃ©e
        run: |
        echo "VidÃ©o rÃ©cupÃ©rÃ©e: SÃ©quence vidÃ©o 22h15-22h45"

  detective:
    needs: [policier-scene, policier-video]
    runs-on: ubuntu-latest
    outputs:
      rapport: ${{ steps.final-report.outputs.conclusion }}
      lieu_arrestation: "42 Avenue du Commerce, SupermarchÃ© SuperPrix"
      autorisation_arrestation: "true"
    steps:
      - name: RÃ©cupÃ©rer les indices
        run: |
          echo "Empreinte : ${{ needs.policier-scene.outputs.empreinte }}"
          echo "VidÃ©o : ${{ needs.policier-video.outputs.video }}"
      - name: Analyser les indices
        run: |
          echo "ANALYSE_EMPREINTE=Empreinte correspond Ã  un suspect connu" >> $GITHUB_ENV
          echo "ANALYSE_VIDEO=Suspect identifiÃ© sur la vidÃ©o Ã  22h30" >> $GITHUB_ENV
      - id: final-report
        run: |
          echo "conclusion=${ANALYSE_EMPREINTE}, ${ANALYSE_VIDEO}, suspect identifiÃ©" >> $GITHUB_OUTPUT

  police:
    needs: detective
    runs-on: ubuntu-latest
    steps:
      - name: Afficher le rapport
        run: |
          echo "Rapport : ${{ needs.detective.outputs.rapport }}"
          echo "Lieu d'arrestation : ${{ needs.detective.outputs.lieu_arrestation }}"
          echo "Autorisation d'arrestation : ${{ needs.detective.outputs.autorisation_arrestation }}"
      - name: VÃ©rifier l'autorisation
        if: ${{ needs.detective.outputs.autorisation_arrestation != 'true' }}
        run: echo "ğŸš¨ EnquÃªte sans suite"
      - name: ProcÃ©der Ã  l'arrestation
        if: ${{ needs.detective.outputs.autorisation_arrestation == 'true' }}
        run: |
          echo "ğŸš” Arrestation effectuÃ©e au lieu: ${{ needs.detective.outputs.lieu_arrestation }}"
